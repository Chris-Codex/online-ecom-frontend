{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport jwt_decode from \"jwt-decode\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport Toast from \"react-native-toast-message\";\nimport baseUrlGenerator from \"../../generator/baseUrlGenerator\";\nexport var SET_CURRENT_USER = \"SET_CURRENT_USER\";\nexport var login = function _callee(user, dispatch) {\n  return _regeneratorRuntime.async(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          fetch(baseUrlGenerator + \"onlineUser/login\", {\n            method: \"POST\",\n            body: JSON.stringify(user),\n            headers: {\n              \"Content-Type\": \"application/json\",\n              Accept: \"application/json\"\n            }\n          }).then(function (res) {\n            return res.json();\n          }).then(function (data) {\n            console.log(\"abi my eye dey pain me\", data);\n\n            if (data) {\n              var _token = data.token;\n              AsyncStorage.setItem(\"token\", _token);\n              AsyncStorage.setItem(\"userwithID\", data._id);\n              AsyncStorage.setItem(\"user\", data);\n              var decoded = jwt_decode(_token);\n              dispatch(setCurrentUser(decoded, user));\n            } else {\n              userLogout(dispatch);\n            }\n          }).catch(function (err) {\n            console.log(\"LOGIN ERROR\", err);\n            Toast.show({\n              type: \"error\",\n              position: \"top\",\n              text1: \"Error\",\n              text2: \"Some went wrong\"\n            });\n            userLogout(dispatch);\n          });\n\n        case 1:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};\nexport var fetchUserProfile = function fetchUserProfile(_id) {\n  fetch(baseUrlGenerator + \"onlineUser/\" + _id, {\n    method: \"GET\",\n    body: JSON.stringify(user),\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Accept: \"application/json\",\n      Authorization: \"Bearer \" + token\n    }\n  }).then(function (res) {\n    return res.json();\n  }).then(function (res) {\n    return console.log(\"STURBORN ERROR\", res);\n  });\n};\nexport var register = function register(dispatch) {\n  AsyncStorage.removeItem(\"token\");\n  dispatch(setCurrentUser({}));\n};\nexport var userLogout = function userLogout(dispatch) {\n  AsyncStorage.removeItem(\"token\");\n  dispatch(setCurrentUser({}));\n};\nexport var setCurrentUser = function setCurrentUser(user, decoded) {\n  return {\n    type: SET_CURRENT_USER,\n    payload: decoded,\n    userProfile: user\n  };\n};","map":{"version":3,"names":["jwt_decode","AsyncStorage","Toast","baseUrlGenerator","SET_CURRENT_USER","login","user","dispatch","fetch","method","body","JSON","stringify","headers","Accept","then","res","json","data","console","log","token","setItem","_id","decoded","setCurrentUser","userLogout","catch","err","show","type","position","text1","text2","fetchUserProfile","Authorization","register","removeItem","payload","userProfile"],"sources":["C:/Users/User/Desktop/myProjectNative/online-ecom-frontend/ContextApi/actions/Authentication.js"],"sourcesContent":["import jwt_decode from \"jwt-decode\";\r\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\r\nimport Toast from \"react-native-toast-message\";\r\nimport baseUrlGenerator from \"../../generator/baseUrlGenerator\";\r\n\r\nexport const SET_CURRENT_USER = \"SET_CURRENT_USER\";\r\n\r\nexport const login = async (user, dispatch) => {\r\n  fetch(`${baseUrlGenerator}onlineUser/login`, {\r\n    method: \"POST\",\r\n    body: JSON.stringify(user),\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Accept: \"application/json\",\r\n    },\r\n  })\r\n    .then((res) => res.json())\r\n    .then((data) => {\r\n      console.log(\"abi my eye dey pain me\", data);\r\n      if (data) {\r\n        const token = data.token;\r\n        AsyncStorage.setItem(\"token\", token);\r\n        AsyncStorage.setItem(\"userwithID\", data._id);\r\n        AsyncStorage.setItem(\"user\", data);\r\n\r\n        const decoded = jwt_decode(token);\r\n        dispatch(setCurrentUser(decoded, user));\r\n      } else {\r\n        userLogout(dispatch);\r\n      }\r\n    })\r\n    .catch((err) => {\r\n      console.log(\"LOGIN ERROR\", err);\r\n      Toast.show({\r\n        type: \"error\",\r\n        position: \"top\",\r\n        text1: \"Error\",\r\n        text2: \"Some went wrong\",\r\n      });\r\n      userLogout(dispatch);\r\n    });\r\n};\r\n\r\nexport const fetchUserProfile = (_id) => {\r\n  fetch(`${baseUrlGenerator}onlineUser/${_id}`, {\r\n    method: \"GET\",\r\n    body: JSON.stringify(user),\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Accept: \"application/json\",\r\n      Authorization: `Bearer ${token}`,\r\n    },\r\n  })\r\n    .then((res) => res.json())\r\n    .then((res) => console.log(\"STURBORN ERROR\", res));\r\n  // .then((res) => {\r\n  // if (res.success === 200) {\r\n  //     dispatch({\r\n  //     type: SET_USER,\r\n  //     payload: res.user,\r\n  //     });\r\n  // } else {\r\n  //     Toast.show({\r\n  //     type: \"error\",\r\n  //     position: \"top\",\r\n  //     text1: \"Login Failed\",\r\n  //     text2: \"Please Try Again\",\r\n  //     visibilityTime: 3000,\r\n  //     topOffset: 50,\r\n  //     });\r\n  // }\r\n};\r\n\r\nexport const register = (dispatch) => {\r\n  AsyncStorage.removeItem(\"token\");\r\n  dispatch(setCurrentUser({}));\r\n};\r\n\r\n//logout user\r\nexport const userLogout = (dispatch) => {\r\n  AsyncStorage.removeItem(\"token\");\r\n  dispatch(setCurrentUser({}));\r\n};\r\n\r\nexport const setCurrentUser = (user, decoded) => {\r\n  return {\r\n    type: SET_CURRENT_USER,\r\n    payload: decoded,\r\n    userProfile: user,\r\n  };\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}
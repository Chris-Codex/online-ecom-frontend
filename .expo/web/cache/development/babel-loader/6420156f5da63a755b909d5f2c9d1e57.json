{"ast":null,"code":"import jwt_decode from \"jwt-decode\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport Toast from \"react-native-toast-message\";\nimport baseUrlGenerator from \"../../generator/baseUrlGenerator\";\nexport var SET_CURRENT_USER = \"SET_CURRENT_USER\";\nexport var login = function login(user, dispatch) {\n  fetch(baseUrlGenerator + \"onlineUser/login\", {\n    method: \"POST\",\n    body: JSON.stringify(user),\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Accept: \"application/json\"\n    }\n  }).then(function (res) {\n    return res.json();\n  }).then(function (data) {\n    if (data) {\n      var _token = data.token;\n      AsyncStorage.setItem(\"token\", _token);\n      var decoded = jwt_decode(_token);\n      dispatch(setCurrentUser(decoded, user));\n    } else {\n      userLogout(dispatch);\n    }\n  }).catch(function (err) {\n    console.log(\"LOGIN ERROR\", err);\n    Toast.show({\n      type: \"error\",\n      position: \"top\",\n      text1: \"Error\",\n      text2: \"Some went wrong\"\n    });\n    userLogout(dispatch);\n  });\n};\nexport var fetchUserProfile = function fetchUserProfile(_id) {\n  fetch(baseUrlGenerator + \"onlineUser/\" + _id, {\n    method: \"GET\",\n    body: JSON.stringify(user),\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Accept: \"application/json\",\n      Authorization: \"Bearer \" + token\n    }\n  }).then(function (res) {\n    return res.json();\n  }).then(function (res) {\n    return console.log(\"STURBORN ERROR\", res);\n  });\n};\nexport var register = function register(dispatch) {\n  AsyncStorage.removeItem(\"token\");\n  dispatch(setCurrentUser({}));\n};\nexport var userLogout = function userLogout(dispatch) {\n  AsyncStorage.removeItem(\"token\");\n  dispatch(setCurrentUser({}));\n};\nexport var setCurrentUser = function setCurrentUser(user, decoded) {\n  return {\n    type: SET_CURRENT_USER,\n    payload: decoded,\n    userProfile: user\n  };\n};","map":{"version":3,"names":["jwt_decode","AsyncStorage","Toast","baseUrlGenerator","SET_CURRENT_USER","login","user","dispatch","fetch","method","body","JSON","stringify","headers","Accept","then","res","json","data","token","setItem","decoded","setCurrentUser","userLogout","catch","err","console","log","show","type","position","text1","text2","fetchUserProfile","_id","Authorization","register","removeItem","payload","userProfile"],"sources":["C:/Users/User/Desktop/myProjectNative/online-ecom-frontend/ContextApi/actions/Authentication.js"],"sourcesContent":["import jwt_decode from \"jwt-decode\";\r\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\r\nimport Toast from \"react-native-toast-message\";\r\nimport baseUrlGenerator from \"../../generator/baseUrlGenerator\";\r\n\r\nexport const SET_CURRENT_USER = \"SET_CURRENT_USER\";\r\n\r\nexport const login = (user, dispatch) => {\r\n  fetch(`${baseUrlGenerator}onlineUser/login`, {\r\n    method: \"POST\",\r\n    body: JSON.stringify(user),\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Accept: \"application/json\",\r\n    },\r\n  })\r\n    .then((res) => res.json())\r\n    .then((data) => {\r\n      if (data) {\r\n        const token = data.token;\r\n        AsyncStorage.setItem(\"token\", token);\r\n        const decoded = jwt_decode(token);\r\n        dispatch(setCurrentUser(decoded, user));\r\n      } else {\r\n        userLogout(dispatch);\r\n      }\r\n    })\r\n    .catch((err) => {\r\n      console.log(\"LOGIN ERROR\", err);\r\n      Toast.show({\r\n        type: \"error\",\r\n        position: \"top\",\r\n        text1: \"Error\",\r\n        text2: \"Some went wrong\",\r\n      });\r\n      userLogout(dispatch);\r\n    });\r\n};\r\n\r\nexport const fetchUserProfile = (_id) => {\r\n  fetch(`${baseUrlGenerator}onlineUser/${_id}`, {\r\n    method: \"GET\",\r\n    body: JSON.stringify(user),\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Accept: \"application/json\",\r\n      Authorization: `Bearer ${token}`,\r\n    },\r\n  })\r\n    .then((res) => res.json())\r\n    .then((res) => console.log(\"STURBORN ERROR\", res));\r\n  // .then((res) => {\r\n  // if (res.success === 200) {\r\n  //     dispatch({\r\n  //     type: SET_USER,\r\n  //     payload: res.user,\r\n  //     });\r\n  // } else {\r\n  //     Toast.show({\r\n  //     type: \"error\",\r\n  //     position: \"top\",\r\n  //     text1: \"Login Failed\",\r\n  //     text2: \"Please Try Again\",\r\n  //     visibilityTime: 3000,\r\n  //     topOffset: 50,\r\n  //     });\r\n  // }\r\n};\r\n\r\nexport const register = (dispatch) => {\r\n  AsyncStorage.removeItem(\"token\");\r\n  dispatch(setCurrentUser({}));\r\n};\r\n\r\n//logout user\r\nexport const userLogout = (dispatch) => {\r\n  AsyncStorage.removeItem(\"token\");\r\n  dispatch(setCurrentUser({}));\r\n};\r\n\r\nexport const setCurrentUser = (user, decoded) => {\r\n  return {\r\n    type: SET_CURRENT_USER,\r\n    payload: decoded,\r\n    userProfile: user,\r\n  };\r\n};\r\n"],"mappings":"AAAA,OAAOA,UAAP,MAAuB,YAAvB;AACA,OAAOC,YAAP,MAAyB,2CAAzB;AACA,OAAOC,KAAP,MAAkB,4BAAlB;AACA,OAAOC,gBAAP;AAEA,OAAO,IAAMC,gBAAgB,GAAG,kBAAzB;AAEP,OAAO,IAAMC,KAAK,GAAG,SAARA,KAAQ,CAACC,IAAD,EAAOC,QAAP,EAAoB;EACvCC,KAAK,CAAIL,gBAAJ,uBAAwC;IAC3CM,MAAM,EAAE,MADmC;IAE3CC,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeN,IAAf,CAFqC;IAG3CO,OAAO,EAAE;MACP,gBAAgB,kBADT;MAEPC,MAAM,EAAE;IAFD;EAHkC,CAAxC,CAAL,CAQGC,IARH,CAQQ,UAACC,GAAD;IAAA,OAASA,GAAG,CAACC,IAAJ,EAAT;EAAA,CARR,EASGF,IATH,CASQ,UAACG,IAAD,EAAU;IACd,IAAIA,IAAJ,EAAU;MACR,IAAMC,MAAK,GAAGD,IAAI,CAACC,KAAnB;MACAlB,YAAY,CAACmB,OAAb,CAAqB,OAArB,EAA8BD,MAA9B;MACA,IAAME,OAAO,GAAGrB,UAAU,CAACmB,MAAD,CAA1B;MACAZ,QAAQ,CAACe,cAAc,CAACD,OAAD,EAAUf,IAAV,CAAf,CAAR;IACD,CALD,MAKO;MACLiB,UAAU,CAAChB,QAAD,CAAV;IACD;EACF,CAlBH,EAmBGiB,KAnBH,CAmBS,UAACC,GAAD,EAAS;IACdC,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BF,GAA3B;IACAvB,KAAK,CAAC0B,IAAN,CAAW;MACTC,IAAI,EAAE,OADG;MAETC,QAAQ,EAAE,KAFD;MAGTC,KAAK,EAAE,OAHE;MAITC,KAAK,EAAE;IAJE,CAAX;IAMAT,UAAU,CAAChB,QAAD,CAAV;EACD,CA5BH;AA6BD,CA9BM;AAgCP,OAAO,IAAM0B,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACC,GAAD,EAAS;EACvC1B,KAAK,CAAIL,gBAAJ,mBAAkC+B,GAAlC,EAAyC;IAC5CzB,MAAM,EAAE,KADoC;IAE5CC,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeN,IAAf,CAFsC;IAG5CO,OAAO,EAAE;MACP,gBAAgB,kBADT;MAEPC,MAAM,EAAE,kBAFD;MAGPqB,aAAa,cAAYhB;IAHlB;EAHmC,CAAzC,CAAL,CASGJ,IATH,CASQ,UAACC,GAAD;IAAA,OAASA,GAAG,CAACC,IAAJ,EAAT;EAAA,CATR,EAUGF,IAVH,CAUQ,UAACC,GAAD;IAAA,OAASU,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BX,GAA9B,CAAT;EAAA,CAVR;AA2BD,CA5BM;AA8BP,OAAO,IAAMoB,QAAQ,GAAG,SAAXA,QAAW,CAAC7B,QAAD,EAAc;EACpCN,YAAY,CAACoC,UAAb,CAAwB,OAAxB;EACA9B,QAAQ,CAACe,cAAc,CAAC,EAAD,CAAf,CAAR;AACD,CAHM;AAMP,OAAO,IAAMC,UAAU,GAAG,SAAbA,UAAa,CAAChB,QAAD,EAAc;EACtCN,YAAY,CAACoC,UAAb,CAAwB,OAAxB;EACA9B,QAAQ,CAACe,cAAc,CAAC,EAAD,CAAf,CAAR;AACD,CAHM;AAKP,OAAO,IAAMA,cAAc,GAAG,SAAjBA,cAAiB,CAAChB,IAAD,EAAOe,OAAP,EAAmB;EAC/C,OAAO;IACLQ,IAAI,EAAEzB,gBADD;IAELkC,OAAO,EAAEjB,OAFJ;IAGLkB,WAAW,EAAEjC;EAHR,CAAP;AAKD,CANM"},"metadata":{},"sourceType":"module"}